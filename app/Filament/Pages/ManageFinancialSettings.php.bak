<?php

namespace App\Filament\Pages;

use App\Settings\FinancialSettings;
use Filament\Forms;
use Filament\Schemas\Schema;
use Filament\Pages\SettingsPage;

class ManageFinancialSettings extends SettingsPage
{
    protected static ?string $navigationIcon = 'heroicon-o-currency-dollar';

    protected static string $settings = FinancialSettings::class;

    protected static ?string $navigationGroup = 'Settings';

    protected static ?int $navigationSort = 3;

    protected static ?string $title = 'Financial Settings';

    protected static ?string $navigationLabel = 'Financial';

    public function form(Schema $schema): Schema
    {
        return $schema
            ->components([
                Forms\Components\Section::make('Currency Settings')
                    ->schema([
                        Forms\Components\Grid::make(2)
                            ->schema([
                                Forms\Components\Select::make('default_currency')
                                    ->label('Default Currency')
                                    ->options([
                                        'USD' => 'US Dollar (USD)',
                                        'EUR' => 'Euro (EUR)',
                                        'GBP' => 'British Pound (GBP)',
                                        'MYR' => 'Malaysian Ringgit (MYR)',
                                        'SGD' => 'Singapore Dollar (SGD)',
                                        'JPY' => 'Japanese Yen (JPY)',
                                        'CNY' => 'Chinese Yuan (CNY)',
                                        'AUD' => 'Australian Dollar (AUD)',
                                        'CAD' => 'Canadian Dollar (CAD)',
                                        'THB' => 'Thai Baht (THB)',
                                        'IDR' => 'Indonesian Rupiah (IDR)',
                                        'INR' => 'Indian Rupee (INR)',
                                    ])
                                    ->required()
                                    ->searchable(),
                                
                                Forms\Components\TextInput::make('currency_symbol')
                                    ->label('Currency Symbol')
                                    ->required()
                                    ->maxLength(10),
                            ]),
                        
                        Forms\Components\Grid::make(3)
                            ->schema([
                                Forms\Components\Select::make('currency_position')
                                    ->label('Currency Position')
                                    ->options([
                                        'before' => 'Before Amount ($100)',
                                        'after' => 'After Amount (100$)',
                                    ])
                                    ->required(),
                                
                                Forms\Components\TextInput::make('decimal_separator')
                                    ->label('Decimal Separator')
                                    ->required()
                                    ->maxLength(1)
                                    ->default('.'),
                                
                                Forms\Components\TextInput::make('thousands_separator')
                                    ->label('Thousands Separator')
                                    ->required()
                                    ->maxLength(1)
                                    ->default(','),
                            ]),
                        
                        Forms\Components\TextInput::make('decimal_places')
                            ->label('Decimal Places')
                            ->numeric()
                            ->minValue(0)
                            ->maxValue(6)
                            ->required(),
                    ]),

                Forms\Components\Section::make('Tax Settings')
                    ->schema([
                        Forms\Components\Grid::make(2)
                            ->schema([
                                Forms\Components\TextInput::make('default_tax_rate')
                                    ->label('Default Tax Rate (%)')
                                    ->numeric()
                                    ->minValue(0)
                                    ->maxValue(100)
                                    ->step(0.01)
                                    ->suffix('%'),
                                
                                Forms\Components\Toggle::make('tax_inclusive_pricing')
                                    ->label('Tax Inclusive Pricing')
                                    ->helperText('When enabled, prices include tax by default'),
                            ]),
                    ]),

                Forms\Components\Section::make('Document Settings')
                    ->schema([
                        Forms\Components\Grid::make(2)
                            ->schema([
                                Forms\Components\Select::make('financial_year_start')
                                    ->label('Financial Year Start')
                                    ->options([
                                        '01-01' => 'January 1st',
                                        '04-01' => 'April 1st',
                                        '07-01' => 'July 1st',
                                        '10-01' => 'October 1st',
                                    ])
                                    ->required(),
                                
                                Forms\Components\Toggle::make('auto_invoice_numbering')
                                    ->label('Auto Invoice Numbering')
                                    ->helperText('Automatically generate invoice numbers'),
                            ]),
                        
                        Forms\Components\Grid::make(3)
                            ->schema([
                                Forms\Components\TextInput::make('invoice_prefix')
                                    ->label('Invoice Prefix')
                                    ->maxLength(10)
                                    ->required(),
                                
                                Forms\Components\TextInput::make('quote_prefix')
                                    ->label('Quote Prefix')
                                    ->maxLength(10)
                                    ->required(),
                                
                                Forms\Components\TextInput::make('purchase_order_prefix')
                                    ->label('Purchase Order Prefix')
                                    ->maxLength(10)
                                    ->required(),
                            ]),
                        
                        Forms\Components\TextInput::make('invoice_number_length')
                            ->label('Invoice Number Length')
                            ->numeric()
                            ->minValue(4)
                            ->maxValue(10)
                            ->required()
                            ->helperText('Length of the auto-generated number part'),
                    ]),
            ]);
    }
}